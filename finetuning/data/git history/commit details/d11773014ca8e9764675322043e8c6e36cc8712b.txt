commit d11773014ca8e9764675322043e8c6e36cc8712b
Author: Michael Catanzaro <mcatanzaro@redhat.com>
Date:   Wed Jun 26 15:59:27 2024 -0500

    Fix leaks when parsing cookies
    
    If the cookie is not well-formed and contains the same attribute twice,
    it will leak. Found by Coverity.

diff --git a/libsoup/cookies/soup-cookie.c b/libsoup/cookies/soup-cookie.c
index 112a61ae..1515d4a5 100644
--- a/libsoup/cookies/soup-cookie.c
+++ b/libsoup/cookies/soup-cookie.c
@@ -209,12 +209,14 @@ parse_one_cookie (const char *header, GUri *origin)
 #define MATCH_NAME(name) ((end - start == strlen (name)) && !g_ascii_strncasecmp (start, name, end - start))
 
 		if (MATCH_NAME ("domain") && has_value) {
+			g_free (cookie->domain);
 			cookie->domain = parse_value (&p, TRUE);
 			if (!*cookie->domain) {
 				g_free (cookie->domain);
 				cookie->domain = NULL;
 			}
 		} else if (MATCH_NAME ("expires") && has_value) {
+			g_clear_object (&cookie->expires);
 			cookie->expires = parse_date (&p);
 		} else if (MATCH_NAME ("httponly")) {
 			cookie->http_only = TRUE;
@@ -232,6 +234,7 @@ parse_one_cookie (const char *header, GUri *origin)
 			}
 			g_free (max_age_str);
 		} else if (MATCH_NAME ("path") && has_value) {
+			g_free (cookie->path);
 			cookie->path = parse_value (&p, TRUE);
 			if (*cookie->path != '/') {
 				g_free (cookie->path);