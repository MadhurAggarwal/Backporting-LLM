
    The upstream patch in Standard Git Diff format is:
    <Patch>
'From f182429e5b1fc034050510da20c93256c4fa9652 Mon Sep 17 00:00:00 2001\nFrom: Patrick Griffis <pgriffis@igalia.com>\nDate: Sat, 16 Nov 2024 12:07:30 -0600\nSubject: [PATCH] Fix heap buffer overflow in soup_content_sniffer_sniff\n\nCo-Author: Ar Jun <pkillarjun@protonmail.com>\n---\n libsoup/content-sniffer/soup-content-sniffer.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a/libsoup/content-sniffer/soup-content-sniffer.c b/libsoup/content-sniffer/soup-content-sniffer.c\nindex de0985eac..b62e48889 100644\n--- a/libsoup/content-sniffer/soup-content-sniffer.c\n+++ b/libsoup/content-sniffer/soup-content-sniffer.c\n@@ -532,7 +532,7 @@ sniff_unknown (SoupContentSniffer *sniffer, GBytes *buffer,\n                guint index_stream = 0;\n                guint index_pattern = 0;\n                gboolean skip_row = FALSE;\n \n-\t\t\twhile ((index_stream < resource_length) &&\n+\t\t\twhile ((index_stream < resource_length - 1) &&\n                    (index_pattern <= type_row->pattern_length)) {\n                    /* Skip insignificant white space ("WS" in the spec) */\n                    if (type_row->pattern[index_pattern] == \' \') {\n-- \nGitLab'
    <end>

    The downstream file code has diverged from upstream.
    Here, the line content in the diverged file is:
532: 			while ((index_stream < resource_length) &&
533: 			       (index_pattern <= type_row->pattern_length)) {
534: 				/* Skip insignificant white space ("WS" in the spec) */
535: 				if (type_row->pattern[index_pattern] == ' ') {
536: 					if (resource[index_stream] == '\x09' ||
537: 					    resource[index_stream] == '\x0a' ||
538: 					    resource[index_stream] == '\x0c' ||
539: 					    resource[index_stream] == '\x0d' ||
540: 					    resource[index_stream] == '\x20')
541: 						index_stream++;
542: 					else
543: 						index_pattern++;
544: 				} else {
545: 					if ((type_row->mask[index_pattern] & resource[index_stream]) != type_row->pattern[index_pattern]) {
546: 						skip_row = TRUE;
547: 						break;
548: 					}


    TASK:
    The upstream patch uses different whitespace, tabs etc. than the downstream code
    Also some lines could be missing / extra in the new file code, from when the patch was created.
    So, update the patch to the new line content.

    Ensure that the patch logic is NOT changed.
    Ensure that line content like newlines, tabs, whitespace etc matches the downstream file code.

    Do NOT give any extra tokens like diff ``` or <patch>.
    Only output the final patch in STANDARD GIT diff format.
