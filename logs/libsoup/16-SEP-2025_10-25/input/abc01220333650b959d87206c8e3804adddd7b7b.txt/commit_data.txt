commit abc01220333650b959d87206c8e3804adddd7b7b
Author: Patrick Griffis <pgriffis@igalia.com>
Date:   Wed Dec 11 04:02:25 2024 +0000

    CI: Add artifact for dist tarballs

diff --git a/.gitlab-ci.yml b/.gitlab-ci.yml
index a8008835..099b604a 100644
--- a/.gitlab-ci.yml
+++ b/.gitlab-ci.yml
@@ -1,3 +1,9 @@
+include:
+  - component: gitlab.gnome.org/GNOME/citemplates/release-service@master
+    inputs:
+      dist-job-name: "fedora-distcheck"
+      tarball-artifact-path: "_build/meson-dist/$CI_PROJECT_NAME-$CI_COMMIT_TAG.tar.xz"
+
 workflow:
   rules:
     - if: $CI_PIPELINE_SOURCE == 'merge_request_event'
@@ -11,6 +17,7 @@ stages:
   - coverage
   - docs
   - deploy
+  - release
 
 .build:
   stage: build
@@ -65,6 +72,16 @@ fedora-scan:
     paths:
       - _build/meson-logs/scanbuild
 
+fedora-distcheck:
+  extends: .build
+  script:
+    - git config --global --add safe.directory $CI_PROJECT_DIR
+    - meson setup _build --auto-features=enabled
+    - meson dist -C _build
+  artifacts:
+    paths:
+      - "_build/meson-dist/*.xz"
+
 fedora-asan:
   stage: build
   tags:
@@ -128,3 +145,4 @@ pages:
       - public
   only:
     - master
+